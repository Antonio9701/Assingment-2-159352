<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Psychological Profiling</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1>Psychological Profiling</h1>
        <p>Welcome to your psychological profile</p>
    </header>

    <div class="container">
        <!-- Display form in a new window -->
        <button onclick="openForm()">Take Personality Test</button>

        <!-- Display input data -->
        <h2>Input Data:</h2>
        <pre id="inputData"></pre>

        <!-- Display profile data -->
        <h2>Psychological Profile:</h2>
        <pre id="profileData"></pre>

        <!-- Display pet images -->
        <h2>Pet Images:</h2>
        <div id="petImages"></div>

        <!-- Display message if the user hasn't taken the test -->
        <p id="noDataMessage"></p>
    </div>

    <script>
        let username = localStorage.getItem('username');
        if (username) username = username.trim();

        // Function to open form in a new window
        function openForm() {
            window.open('/form', '_blank');
        }

        // Function to fetch and display pet images
        function fetchPetImages() {
            fetch(`/view/${username}/petImages`)
                // rest of the function
        }

        // Function to fetch and display input data and profile data
        // Function to fetch and display input data and profile data
function fetchData() {
    // Fetch input data
    fetch(`/view/${username}/input`)
        .then(response => response.json())
        .then(data => {
            console.log("Fetched Input data: ", data);
            document.getElementById('inputData').textContent = JSON.stringify(data, null, 2);
        })
        .catch((error) => {
            console.error('Error:', error);
        });

    // Fetch profile data
    fetch(`/view/${username}/profile`)
        .then(response => response.json())
        .then(data => {
            console.log("Fetched Profile data: ", data);
            document.getElementById('profileData').textContent = JSON.stringify(data, null, 2);
        })
        .catch((error) => {
            console.error('Error:', error);
        });

    // Fetch pet images
    fetchPetImages();
}

        // Call fetchData function after DOM content is loaded
        if (username) {
            // Load data only if username is found
            document.addEventListener('DOMContentLoaded', fetchData);
        } else {
            // Display a message instructing the user to take the test first if no username is found
            document.getElementById('noDataMessage').innerText = "No data available. Please take the personality test first.";
        }
    </script>
</body>
</html>